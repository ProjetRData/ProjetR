---
title: "Analyse des facteurs influençant les loyers à Dakar"
output: html_document
---

```{r setup, include=FALSE, echo=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

```{r, echo = FALSE}
# Chargement des données
data <- read.csv("~/Téléchargements/dakar.csv", stringsAsFactors = TRUE)

# Aperçu des données
str(data)
summary(data$Loyer)
```

## Figure 1 : Distribution des loyers

```{r, echo = FALSE}
# Histogramme des loyers
hist(data$Loyer, 
     breaks = 15,
     col = "lightblue",
     main = "Distribution des loyers à Dakar",
     xlab = "Loyer (milliers FCFA)",
     ylab = "Fréquence",
     border = "white")
abline(v = median(data$Loyer), col = "red", lwd = 2, lty = 2)
legend("topright", legend = paste("Médiane =", median(data$Loyer)), 
       col = "red", lty = 2, lwd = 2)
```

**Commentaire :** Distribution très asymétrique avec quelques loyers très élevés.

## Figure 2 : Loyer selon la surface habitable

```{r, echo = FALSE}
# Nuage de points avec ligne de tendance
plot(data$SurfHabitable, data$Loyer,
     main = "Relation entre surface habitable et loyer",
     xlab = "Surface habitable (m²)",
     ylab = "Loyer (milliers FCFA)",
     pch = 19,
     col = "darkblue")

# Ajout d'une ligne de régression
abline(lm(Loyer ~ SurfHabitable, data = data), col = "red", lwd = 2)

# Coefficient de corrélation
cor_surf <- cor(data$SurfHabitable, data$Loyer)
text(300, 2000, paste("Corrélation =", round(cor_surf, 2)), col = "red")
```

**Commentaire :** Relation positive entre surface et loyer, mais avec beaucoup de variabilité.

## Figure 3 : Loyer selon le type de bien

```{r, echo = FALSE}
# Boxplot par type de bien
boxplot(Loyer ~ Type, data = data,
        main = "Loyer selon le type de bien",
        xlab = "Type de bien",
        ylab = "Loyer (milliers FCFA)",
        col = c("lightgreen", "lightyellow"),
        border = "darkgray")

# Moyennes
means <- tapply(data$Loyer, data$Type, mean)
points(1:2, means, pch = 18, col = "red", cex = 2)
legend("topright", legend = "Moyenne", pch = 18, col = "red", pt.cex = 2)
```

**Commentaire :** Les villas ont généralement des loyers plus élevés que les appartements.

## Figure 4 : Loyer selon le standing

```{r, echo = FALSE}
# Boxplot par standing
boxplot(Loyer ~ Standing, data = data,
        main = "Loyer selon le standing du bien",
        xlab = "Standing (Oui = Haut standing)",
        ylab = "Loyer (milliers FCFA)",
        col = c("lightcoral", "lightsteelblue"),
        border = "darkgray")

# Test statistique simple
t_test <- t.test(Loyer ~ Standing, data = data)
text(1.5, max(data$Loyer) * 0.9, 
     paste("p-value =", round(t_test$p.value, 4)), 
     col = "red")
```

**Commentaire :** Le standing a un impact significatif sur le loyer.

## Figure 5 : Loyer selon le standing du quartier

```{r, echo = FALSE}
# Réorganiser les niveaux pour un ordre logique
data$StandingQuartier <- factor(data$StandingQuartier, 
                                levels = c("popu", "moy", "bourge"))

boxplot(Loyer ~ StandingQuartier, data = data,
        main = "Loyer selon le standing du quartier",
        xlab = "Standing du quartier",
        ylab = "Loyer (milliers FCFA)",
        col = c("pink", "lightyellow", "lightgreen"),
        names = c("Populaire", "Moyen", "Bourgeois"))
```

**Commentaire :** Le standing du quartier influence fortement le loyer.

## Figure 6 : Loyer selon la distance au centre-ville

```{r, echo = FALSE}
# Réorganiser pour un ordre logique
data$DistCtrVille <- factor(data$DistCtrVille, 
                            levels = c("0", "inf1km", "1a5km", "sup5km"))

boxplot(Loyer ~ DistCtrVille, data = data,
        main = "Loyer selon la distance au centre-ville",
        xlab = "Distance au centre-ville",
        ylab = "Loyer (milliers FCFA)",
        col = rainbow(4),
        names = c("Centre", "<1km", "1-5km", ">5km"),
        las = 2)
```

**Commentaire :** La proximité du centre-ville semble associée à des loyers plus élevés.

## Tableau récapitulatif des corrélations

```{r, echo = FALSE}
# Variables numériques pertinentes
vars_num <- c("SurfHabitable", "SurfTerrain", "NbPieces", "NbChamBur", "NbSDB")
cor_matrix <- cor(data[, c("Loyer", vars_num)])
round(cor_matrix[1, -1], 3)
```